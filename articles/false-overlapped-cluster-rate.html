<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>False Overlapped-Cluster Rate (FOCR) Framework for Multiple Testing Problems with Topological Constraints • focr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="False Overlapped-Cluster Rate (FOCR) Framework for Multiple Testing Problems with Topological Constraints">
<meta property="og:description" content="focr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">focr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/false-overlapped-cluster-rate.html">False Overlapped-Cluster Rate (FOCR) Framework for Multiple Testing Problems with Topological Constraints</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/dipterix/focr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="false-overlapped-cluster-rate_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>False Overlapped-Cluster Rate (FOCR) Framework for Multiple Testing Problems with Topological Constraints</h1>
                        <h4 class="author">Zhengjia Wang</h4>
            
      
      <small class="dont-index">Source: <a href="http://github.com/dipterix/focr/blob/master/vignettes/false-overlapped-cluster-rate.Rmd"><code>vignettes/false-overlapped-cluster-rate.Rmd</code></a></small>
      <div class="hidden name"><code>false-overlapped-cluster-rate.Rmd</code></div>

    </div>

    
    
<p>In continuum data, we often want to find the support of the functions. This problem can be solved by simultaneously testing <span class="math inline">\(H_{0}(s): f(s)=0\)</span> and find <span class="math inline">\(s\)</span> such that null hypotheses are rejected. In many conventional multiple testing procedures, each <span class="math inline">\(s\)</span> is treated separately. However, in functional settings, <span class="math inline">\(f(s)\)</span> is affected by <span class="math inline">\(s'\)</span> nearby. It is more reasonable to take <span class="math inline">\(H_{0}(s'), \forall s'\)</span> near <span class="math inline">\(s\)</span> into account.</p>
<p>The <code>FOCR</code> framework provides a flexible framework allowing aggregating blocks/clusters of <span class="math inline">\(s\)</span>. The clusters of different <span class="math inline">\(s\)</span> can be overlapped. Our first goal is to find connected regions that contain significant points. Then we perform post-selection inferences on the blocks and further select hypotheses that controls the FDR. This two-stage framework tends to be more powerful than applying FDR control methods directly to marginal unconditioned p-values. It also prevents inflated FDR for methods such as <code>LAWS</code><a name="cite-cai2021laws"></a>[<a href="#bib-cai2021laws">3</a>] and <code>SABHA</code><a name="cite-li2019multiple"></a>[<a href="#bib-li2019multiple">4</a>] under dependence.</p>
<p>This package <code>focr</code> provides a two-stage multiple testing control procedure:</p>
<ul>
<li>In the first stage, clusters of hypotheses are rejected as regions of interests (<code>ROI</code>), with <strong>FOCR</strong> controlled at desired level; (see function <code>focr_initial</code> for documentation)</li>
<li>In the second stage, conditional p-values are calculated in a post-selection inference fashion. <strong>FDR</strong> control procedures are applied to these p-values to further select individual hypotheses. (See function <code>focr</code> for documentation)</li>
</ul>
<p>In the rest of this vignette, we refer to <code>FOCR framework</code> or <code>FOCR-XXX</code> as this two-stage procedure where <code>XXX</code> is the name of post-selection procedure, and <code>FOCR</code> or <code>FOCR error</code> as the type-I error measure for overlapped blocks.</p>
<div id="a-basic-example" class="section level2">
<h2 class="hasAnchor">
<a href="#a-basic-example" class="anchor"></a>A basic example</h2>
<p>We generate a functional data as follows. In the figure, the red solid line is the underlying step function. The blue line is the data sample mean, and ribbon around is the <code>95%</code> point-wise confidence interval. Our goal is to find the support of the function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dipterix.github.io/focr">focr</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">400</span><span class="op">)</span>
<span class="va">generator</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulation.html">simulation_data_1D</a></span><span class="op">(</span>n_points <span class="op">=</span> <span class="fl">1000</span>, mu_type <span class="op">=</span> <span class="st">'step'</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">generator</span><span class="op">$</span><span class="fu">gen_data</span><span class="op">(</span>snr <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">generator</span>, data <span class="op">=</span> <span class="va">data</span>, snr <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="false-overlapped-cluster-rate_files/figure-html/setup-1.png" width="576"></p>
<p>We apply the <code>FOCR-BH</code> approach to control the FDR at level 0.05. <code>FOCR-BH</code> uses the <code>Benjamini-Hochberg</code> (<code>BH</code>) procedure as the FDR control method in stage-II.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/focr.html">focr</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, block_size <span class="op">=</span> <span class="fl">21</span>, 
            alpha <span class="op">=</span> <span class="fl">0.05</span>, fdr_method <span class="op">=</span> <span class="st">'BH'</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Let’s plot <span class="math inline">\(s\)</span> where the null hypotheses <span class="math inline">\(\mu(s) = 0\)</span> are rejected. The orange line segments indicate the initial rejections that control the <code>FOCR</code> (cluster-level <code>ROI</code>). The blue line segments are the <code>FOCR-BH</code> final rejections that control the <code>FDR</code> (individual level).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">generator</span><span class="op">$</span><span class="va">mu</span>, type <span class="op">=</span> <span class="st">'l'</span>, col <span class="op">=</span> <span class="st">'red'</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/abseg.html">abseg</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">rej_hypotheses</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.3</span>, col <span class="op">=</span> <span class="st">'orange3'</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/abseg.html">abseg</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">post_selection</span><span class="op">$</span><span class="va">rejs</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, col <span class="op">=</span> <span class="st">'blue'</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="false-overlapped-cluster-rate_files/figure-html/unnamed-chunk-2-1.png" width="576"></p>
<p>To calculate the false discovery proportion and statistical power of this run,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># power &amp; FDP</span>
<span class="fu"><a href="../reference/fdp-pwr.html">fdp</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">post_selection</span><span class="op">$</span><span class="va">rejs</span>, <span class="va">generator</span><span class="op">$</span><span class="va">support</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.02763385</span>
<span class="fu"><a href="../reference/fdp-pwr.html">pwr</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">post_selection</span><span class="op">$</span><span class="va">rejs</span>, <span class="va">generator</span><span class="op">$</span><span class="va">support</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.9894552</span></code></pre></div>
</div>
<div id="d-3d-spatial-data" class="section level2">
<h2 class="hasAnchor">
<a href="#d-3d-spatial-data" class="anchor"></a>2D, 3D spatial data</h2>
<p>Let’s generate a 2D sample data (<span class="math inline">\(150\times 158\)</span>). The red colored pixels are non-zeros, and white pixels are true null pixels. Our goal is to extract non-zero pixels (red).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dipterix.github.io/focr">focr</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">400</span><span class="op">)</span>
<span class="va">generator</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulation.html">simulation_data_2D</a></span><span class="op">(</span>cov_type <span class="op">=</span> <span class="st">'AR'</span>, n_obs <span class="op">=</span> <span class="fl">100</span>, rho <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">generator</span><span class="op">$</span><span class="fu">gen_data</span><span class="op">(</span>snr <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="va">generator</span><span class="op">$</span><span class="va">mu</span>
<span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'white'</span>, <span class="st">'red'</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">64</span><span class="op">)</span>
<span class="va">pal2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'red'</span>, <span class="st">'white'</span>, <span class="st">'white'</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">64</span><span class="op">)</span>
<span class="va">pal3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#FF8181"</span>, <span class="st">'white'</span>, <span class="st">"#FF8181"</span>, <span class="st">'red'</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">64</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span><span class="va">mu</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">pal</span>, main <span class="op">=</span> <span class="st">"Underlying image"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">pal3</span>, main <span class="op">=</span> <span class="st">"Sample mean"</span><span class="op">)</span></code></pre></div>
<p><img src="false-overlapped-cluster-rate_files/figure-html/2D-setup-1.png" width="672"></p>
<p>For each pixel <span class="math inline">\(s\)</span>, we test <span class="math inline">\(H_{0}(s): f(s)=0\)</span> versus <span class="math inline">\(H_{1}(s): f(s)\neq 0\)</span>. For <code>FOCR</code>-based methods, we need to provide block size (diameter in pixels + 1). A proper block size can be determined from <code>cor(data[,1:50])[1,]</code>. The correlation between the first pixel and the second pixel is 0.3, and the correlation between the first pixel and the third pixel is 0.009 (small). Therefore, only adjacent pixels are correlated, hence the block radius is 1, and <code>block_size=1x2+1=3</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Run FOCR-BH</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="va">block_size</span> <span class="op">&lt;-</span> <span class="fl">15</span>
<span class="va">bandwidth</span> <span class="op">&lt;-</span> <span class="fl">3.5</span>
<span class="va">res_LAWS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/focr.html">focr</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, block_size <span class="op">=</span> <span class="va">block_size</span>, 
            alpha <span class="op">=</span> <span class="fl">0.05</span>, fdr_method <span class="op">=</span> <span class="st">'LAWS'</span>, bandwidth <span class="op">=</span> <span class="va">bandwidth</span>,
            dimension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">res_SABHA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/focr.html">focr</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, block_size <span class="op">=</span> <span class="va">block_size</span>, 
            alpha <span class="op">=</span> <span class="fl">0.05</span>, fdr_method <span class="op">=</span> <span class="st">'SABHA'</span>, bandwidth <span class="op">=</span> <span class="va">bandwidth</span>,
            dimension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">res_BH</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/focr.html">focr</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, block_size <span class="op">=</span> <span class="va">block_size</span>,
               alpha <span class="op">=</span> <span class="fl">0.05</span>, fdr_method <span class="op">=</span> <span class="st">'BH'</span>, 
               dimension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Notice <code>data</code> is flattened as a matrix of dimension <span class="math inline">\(100 \times 23700\)</span> (100 observations and <span class="math inline">\(150\times 158\)</span> columns)</p>
<p>The following figure shows the <code>FOCR</code> conditional p-values and <code>FOCR-LAWS</code> final rejections side-by-side. As comparisons, we also show the results of <code>LAWS</code><a name="cite-cai2021laws"></a>[<a href="#bib-cai2021laws">3</a>] and <code>BH</code><a name="cite-benjamini1995controlling"></a>[<a href="#bib-benjamini1995controlling">1</a>] procedure on unconditional p-values. Under dependence, the <code>FOCR-LAWS</code> avoids inflated FDR compared to original LAWS method. Our approach also tends to select less isolated pixels outside of the cluster. It is also more powerful than the <code>BH</code> procedure.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span>
<span class="va">image_dimension</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>
<span class="va">plot_rejections</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rej</span>, <span class="va">method</span><span class="op">)</span><span class="op">{</span>
  <span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">image_dimension</span><span class="op">)</span>
  <span class="va">focr_bh</span> <span class="op">&lt;-</span> <span class="va">rej</span><span class="op">$</span><span class="va">rejs</span>
  <span class="va">img</span><span class="op">[</span><span class="va">focr_bh</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span><span class="va">img</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">pal</span>, asp <span class="op">=</span> <span class="fl">1</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,
        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">'%s rejections\nFDP: %.1f%%, Power: %.1f%%'</span>,
                       <span class="va">method</span>, <span class="fu"><a href="../reference/fdp-pwr.html">fdp</a></span><span class="op">(</span><span class="va">focr_bh</span>, <span class="va">generator</span><span class="op">$</span><span class="va">support</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>,
                       <span class="fu"><a href="../reference/fdp-pwr.html">pwr</a></span><span class="op">(</span><span class="va">focr_bh</span>, <span class="va">generator</span><span class="op">$</span><span class="va">support</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Plot conditional p-values</span>
<span class="va">cond_pvals</span> <span class="op">&lt;-</span> <span class="va">res_LAWS</span><span class="op">$</span><span class="va">cond_pvals</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">cond_pvals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">mu</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span><span class="va">cond_pvals</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">pal2</span>, 
      main <span class="op">=</span> <span class="st">'FOCR conditional p-values'</span>, asp <span class="op">=</span> <span class="fl">1</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Plot final rejections</span>
<span class="fu">plot_rejections</span><span class="op">(</span><span class="va">res_LAWS</span><span class="op">$</span><span class="va">post_selection</span>, <span class="va">res_LAWS</span><span class="op">$</span><span class="va">method</span><span class="op">)</span>
<span class="fu">plot_rejections</span><span class="op">(</span><span class="va">res_SABHA</span><span class="op">$</span><span class="va">post_selection</span>, <span class="va">res_SABHA</span><span class="op">$</span><span class="va">method</span><span class="op">)</span>
<span class="fu">plot_rejections</span><span class="op">(</span><span class="va">res_BH</span><span class="op">$</span><span class="va">post_selection</span>, <span class="va">res_BH</span><span class="op">$</span><span class="va">method</span><span class="op">)</span>

<span class="co"># Compare with methods on unconditional p-values</span>
<span class="va">pvals</span> <span class="op">&lt;-</span> <span class="va">res_BH</span><span class="op">$</span><span class="va">uncond_pvals</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">pvals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">image_dimension</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span><span class="va">pvals</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">pal2</span>, 
      main <span class="op">=</span> <span class="st">'Unconditional p-values'</span>, asp <span class="op">=</span> <span class="fl">1</span>, axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>


<span class="co"># Under dependence, LAWS must use large bandwidth</span>
<span class="co"># and small purity value (initial filter) to avoid </span>
<span class="co"># inflated FDR, therefore we cannot use small ones </span>
<span class="co"># as FOCR-LAWS</span>
<span class="va">rej_LAWS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdr-controls.html">LAWS</a></span><span class="op">(</span><span class="va">pvals</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, bandwidth <span class="op">=</span> <span class="va">bandwidth</span>, 
                 dimension <span class="op">=</span> <span class="st">'two'</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">rej_SABHA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdr-controls.html">SABHA</a></span><span class="op">(</span><span class="va">pvals</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, bandwidth <span class="op">=</span> <span class="va">bandwidth</span>, 
                   dimension <span class="op">=</span> <span class="st">'two'</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">rej_BH</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdr-controls.html">BH</a></span><span class="op">(</span><span class="va">pvals</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="fu">plot_rejections</span><span class="op">(</span><span class="va">rej_LAWS</span>, <span class="st">'LAWS'</span><span class="op">)</span>
<span class="fu">plot_rejections</span><span class="op">(</span><span class="va">rej_SABHA</span>, <span class="st">'SABHA'</span><span class="op">)</span>
<span class="fu">plot_rejections</span><span class="op">(</span><span class="va">rej_BH</span>, <span class="st">'BH'</span><span class="op">)</span></code></pre></div>
<p><img src="false-overlapped-cluster-rate_files/figure-html/FOCR-LAWS-2D-1.png" width="672"></p>
</div>
<div id="choices-of-post-selection-fdr-control-procedures" class="section level2">
<h2 class="hasAnchor">
<a href="#choices-of-post-selection-fdr-control-procedures" class="anchor"></a>Choices of post-selection FDR control procedures</h2>
<p>The built-in post-selection FDR procedures are:</p>
<ul>
<li>
<code>BH</code> <a name="cite-benjamini1995controlling"></a>(<a href="#bib-benjamini1995controlling">Benjamini and Hochberg, 1995</a>): controls the FDR under independence or <code>PRDS</code>
</li>
<li>
<code>BY</code> <a name="cite-benjamini2001control"></a>(<a href="#bib-benjamini2001control">Benjamini and Yekutieli, 2001</a>): controls the FDR under arbitrary dependence</li>
<li>
<code>SABHA</code> <a name="cite-li2019multiple"></a>(<a href="#bib-li2019multiple">Li and Barber, 2019</a>): controls the FDR under independence (or asymptotically under weak dependence)</li>
<li>
<code>LAWS</code> <a name="cite-cai2021laws"></a>(<a href="#bib-cai2021laws">Cai, Sun, and Xia, 2021</a>): controls the FDR under independence (or asymptotically under weak dependence)</li>
</ul>
<p>The post-selection FDR method can be specified via <code>fdr_method</code> parameter. For example,</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Change `fdr_method` to BH, BY, SABHA, or LAWS</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/focr.html">focr</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, block_size <span class="op">=</span> <span class="fl">3</span>, 
            alpha <span class="op">=</span> <span class="fl">0.05</span>, fdr_method <span class="op">=</span> <span class="st">'BY'</span><span class="op">)</span></code></pre></div>
<p>Alternatively, <code>fdr_method</code> can be a custom function as follows:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#' @param pvals conditional p-values</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#' @param alpha FDR level to control</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#' @param ... other parameters needed</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>my_method &lt;-<span class="st"> </span><span class="cf">function</span>(pvals, alpha, ...){</span>
<span id="cb9-5"><a href="#cb9-5"></a>  (your code here)</span>
<span id="cb9-6"><a href="#cb9-6"></a>}</span>
<span id="cb9-7"><a href="#cb9-7"></a>res &lt;-<span class="st"> </span><span class="kw">focr</span>(<span class="dt">data =</span> data, <span class="dt">block_size =</span> <span class="dv">3</span>, </span>
<span id="cb9-8"><a href="#cb9-8"></a>            <span class="dt">alpha =</span> <span class="fl">0.05</span>, <span class="dt">fdr_method =</span> my_method)</span></code></pre></div>
<p>The returned values by <code>my_method</code> will be accessible as <code>res$post_selection</code>.</p>
</div>
<div id="advanced-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-usage" class="anchor"></a>Advanced usage</h2>
<p>The function <code><a href="../reference/focr.html">focr()</a></code> runs the post-selection FDR control procedure right after the stage-I. Although convenient, it might not be optimal in some scenarios. Under the following scenarios, it is highly recommended to use the <code>focr_initial</code> function:</p>
<ul>
<li>cluster block is not sliding window and need to be specified manually</li>
<li>data correlation is given</li>
</ul>
<p>The definition of <code>focr_initial</code> function is:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>focr_initial &lt;-<span class="st"> </span><span class="cf">function</span>(</span>
<span id="cb10-2"><a href="#cb10-2"></a>  data, data_corr, blocks, <span class="dt">nblocks =</span> <span class="kw">ncol</span>(data), <span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>, </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">side =</span> <span class="kw">c</span>(<span class="st">'two'</span>, <span class="st">'left'</span>, <span class="st">'right'</span>), ...)</span></code></pre></div>
<p>The <code>data_corr</code> allows prespecified correlation matrix. <code>blocks</code> can be a list of column indices or a function that returns column indices. When <code>blocks</code> is a list, <code>nblocks</code> is ignored. When <code>blocks</code> is a function, <code>nblocks</code> defines the total number of blocks.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dipterix.github.io/focr">focr</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">generator</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulation.html">simulation_data_1D</a></span><span class="op">(</span>n_points <span class="op">=</span> <span class="fl">1000</span>, mu_type <span class="op">=</span> <span class="st">'step'</span>, cov_type <span class="op">=</span> <span class="st">'iid'</span><span class="op">)</span>
<span class="co">#&gt; iid error</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">generator</span><span class="op">$</span><span class="fu">gen_data</span><span class="op">(</span>snr <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="co">#&gt; [1]  100 1000</span>

<span class="co"># Run stage-I with customized blocks</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/focr.html">focr_initial</a></span><span class="op">(</span><span class="va">data</span>, blocks <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">col</span> <span class="op">%in%</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">{</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">col</span> <span class="op">%in%</span> <span class="fl">101</span><span class="op">:</span><span class="fl">400</span><span class="op">)</span><span class="op">{</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">101</span><span class="op">:</span><span class="fl">600</span><span class="op">)</span> <span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">col</span> <span class="op">%in%</span> <span class="fl">401</span><span class="op">:</span><span class="fl">800</span><span class="op">)</span><span class="op">{</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">401</span><span class="op">:</span><span class="fl">800</span><span class="op">)</span> <span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">col</span> <span class="op">%in%</span> <span class="fl">801</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">601</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span> <span class="op">}</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p>There are 4 blocks in this case:</p>
<ul>
<li>Block 1: column 1-100</li>
<li>Block 2: column 101-600 (kernel 101-400, overlapped with block 3)</li>
<li>Block 3: column 401-800 (kernel 401-800, overlapped with block 2 and 4)</li>
<li>Block 4: column 601-1000 (kernel 801-1000, overlapped with block 3)</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">generator</span><span class="op">$</span><span class="va">mu</span>, col <span class="op">=</span> <span class="st">'red'</span>, type <span class="op">=</span> <span class="st">'n'</span>, ylab <span class="op">=</span> <span class="st">''</span>, 
     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, yaxt <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">50</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.3</span>, <span class="st">"Block 1"</span>, col <span class="op">=</span> <span class="st">'blue'</span><span class="op">)</span>
<span class="fu"><a href="../reference/abseg.html">abseg</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.4</span>, col <span class="op">=</span> <span class="st">'blue'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">350</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, <span class="st">"Block 2"</span>, col <span class="op">=</span> <span class="st">'green'</span><span class="op">)</span>
<span class="fu"><a href="../reference/abseg.html">abseg</a></span><span class="op">(</span><span class="fl">101</span><span class="op">:</span><span class="fl">600</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.6</span>, col <span class="op">=</span> <span class="st">'green'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">600</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.6</span>, <span class="st">"Block 3"</span>, col <span class="op">=</span> <span class="st">'orange'</span><span class="op">)</span>
<span class="fu"><a href="../reference/abseg.html">abseg</a></span><span class="op">(</span><span class="fl">401</span><span class="op">:</span><span class="fl">800</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.8</span>, col <span class="op">=</span> <span class="st">'orange'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">800</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.9</span>, <span class="st">"Block 4"</span>, col <span class="op">=</span> <span class="st">'purple'</span><span class="op">)</span>
<span class="fu"><a href="../reference/abseg.html">abseg</a></span><span class="op">(</span><span class="fl">601</span><span class="op">:</span><span class="fl">1000</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, col <span class="op">=</span> <span class="st">'purple'</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">cond_pvals</span>, type<span class="op">=</span><span class="st">'l'</span>, ylab <span class="op">=</span> <span class="st">''</span>, 
     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="st">'Conditional p-value &amp; '</span><span class="op">~</span><span class="fu">mu</span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">generator</span><span class="op">$</span><span class="va">mu</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span></code></pre></div>
<p><img src="false-overlapped-cluster-rate_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>The conditional p-values are calculated and stored at <code>res$cond_pvals</code>. It can be used for further inference (such as FDR control). For example:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rej</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fdr-controls.html">LAWS</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">cond_pvals</span>, bandwidth <span class="op">=</span> <span class="fl">20</span>, dimension <span class="op">=</span> <span class="st">'one'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">generator</span><span class="op">$</span><span class="va">mu</span>, col <span class="op">=</span> <span class="st">'red'</span>, ylab <span class="op">=</span> <span class="st">''</span>, 
     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>,<span class="fl">1</span><span class="op">)</span>, yaxt <span class="op">=</span> <span class="st">'n'</span>, type <span class="op">=</span> <span class="st">'l'</span>,
     main <span class="op">=</span> <span class="st">"Undelying mean (red) and rejected hypotheses (blue)"</span><span class="op">)</span>
<span class="fu"><a href="../reference/abseg.html">abseg</a></span><span class="op">(</span><span class="va">rej</span><span class="op">$</span><span class="va">rejs</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>, col <span class="op">=</span> <span class="st">'blue'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">750</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span>
  <span class="st">"FDP: %.1f%%; Power: %.1f%%"</span>,
  <span class="fu"><a href="../reference/fdp-pwr.html">fdp</a></span><span class="op">(</span><span class="va">rej</span><span class="op">$</span><span class="va">rejs</span>, <span class="va">generator</span><span class="op">$</span><span class="va">support</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,
  <span class="fu"><a href="../reference/fdp-pwr.html">pwr</a></span><span class="op">(</span><span class="va">rej</span><span class="op">$</span><span class="va">rejs</span>, <span class="va">generator</span><span class="op">$</span><span class="va">support</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="false-overlapped-cluster-rate_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<p><a name="bib-benjamini1995controlling"></a><a href="#cite-benjamini1995controlling">[1]</a> Y. Benjamini and Y. Hochberg. “Controlling the false discovery rate: a practical and powerful approach to multiple testing”. In: <em>Journal of the Royal statistical society: series B (Methodological)</em> 57.1 (1995), pp. 289-300.</p>
<p><a name="bib-benjamini2001control"></a><a href="#cite-benjamini2001control">[2]</a> Y. Benjamini and D. Yekutieli. “The control of the false discovery rate in multiple testing under dependency”. In: <em>Annals of statistics</em> (2001), pp. 1165-1188.</p>
<p><a name="bib-cai2021laws"></a><a href="#cite-cai2021laws">[3]</a> T. T. Cai, W. Sun, and Y. Xia. “Laws: A locally adaptive weighting and screening approach to spatial multiple testing”. In: <em>Journal of the American Statistical Association</em> (2021), pp. 1-14.</p>
<p><a name="bib-li2019multiple"></a><a href="#cite-li2019multiple">[4]</a> A. Li and R. F. Barber. “Multiple testing with the structure-adaptive Benjamini-Hochberg algorithm”. In: <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 81.1 (2019), pp. 45-74.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zhengjia Wang, Meng Li.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
